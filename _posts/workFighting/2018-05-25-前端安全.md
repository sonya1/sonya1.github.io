---
layout: post
title: XSS与CSRF
category: workFighting
tags: 安全
keywords: XSS与CSRF
description: XSS与CSRF
---

## XSS（Cross-site Scripting） 跨站脚本攻击
原理：攻击者向有XSS漏洞的网站中传入恶意的html代码，当其他用户浏览该网站时，这段html代码会自动执行，从而达到攻击的目的。

比如：盗取用户cookie、破坏页面结构、重定向到其它网站。

XSS攻击类似于SQL注入攻击，攻击之前，我们先找到一个存在XSS漏洞的网站，漏洞有两种，一种是：DOM Based XSS漏洞，另一种是Stored XSS漏洞。

理论上，所有可输入的地方没有对输入数据进行处理的话，都会存在XSS漏洞。

DOM Based XSS：基于网页DOM结构的攻击

Stored XSS：存储式XSS漏洞，攻击代码存储到服务器或数据库中。

解释二：被动式，注入攻击的一种，用于客户端的攻击方式。发生在目标网站中目标用户的浏览器层面上，当用户浏览器渲染整个html文档过程中出现了不被预期的脚
本指令并执行，XSS就会发生。

总的来说，XSS就是想尽一切办法将脚本内容在目标网站中的目标用户的浏览器上解析执行。

### 如何预防
完善的过滤体系：对用户的输入进行过滤或者字符转换。

例如

"<"转换为"& l t ;" 

">"转换为"& g t ;"

"&"转换为"& a m p;" 

"(引号)转换为"& q u o t"

## CSRF（Cross-site Request Forgery）跨站请求伪造
盗用受信任用户的身份，并以此身份来向网站恶意请求。(利用网站对用户的信任进行攻击)


### CSRF攻击攻击原理及过程如下：

其中Web A为存在CSRF漏洞的网站，Web B为攻击者构建的恶意网站，User C为Web A网站的合法用户。

1. 用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；

2.在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；

3. 用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B；

4. 网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；

5. 浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。 


### 要完成一次CSRF攻击，受害者必须完成的步骤：

- 1.登陆受信任网站A，并在本地生成Cookie

- 2.在不登出的情况下，访问危险网站B

### 如何预防
1.检查包头中的Referer参数，确保来自正确的页面。

2.对于任何重要的请求都需要重新验证用户的身份

3.创建一个唯一的token，将其在服务器端session中及客户端cookie中，对于任何请求，都检查二者是否一致。


 [参考：](https://blog.csdn.net/stpeace/article/details/53512283)
